# 一些mysql的优化点



这篇文章提供了mysql查询优化的一些方案和建议.

<!--more-->


## 一 前言

在使用sql进行查询的时候，就会经常会遇到查询速度过慢，因为掌握一些优化的小技巧，会大大帮助我们提高sql的查询速率

## 二 优化的思路和原则有哪些

1. 优化更需要优化的查询.
2. 从explain入手.
3. 用小结果集驱动大结果集.
4. 尽可能在索引中完成排序.
5. 只取出自己需要的字段.
6. 使用最有效的过滤条件.
7. 尽可能避免复杂的join.

### 1 优化更需要优化的查询
  高并发的低消耗的查询对整个系统的影响远大于低并发高消耗的查询

### 2 从explain入手
explain可以告诉你这个查询在数据库中是一个什么样的执行计划来实现的。
首先我们需要一个目标，通过不断的调整尝试，再借助explain来验证结果是否满足自己的需求，直到达到预期的结果


## 三 合理利用Explain
explain关键字段的展示


字段     | 说明 
-------- | -----
select_type | 查询类型：<br>DEPENDENT SUBQUERY : 子查询中内层的第一个SELECT,依赖于外部查询结果集；<br>DEPENDENT UNION：子查询中的UNION中从第二个SELECT 开始的后面所有SELECT,同样依赖于外部查询结果集;<br>PRIMARY: 子查询中的最外层查询，不是主键查询；<br>SUBQUERY：子查询内层查询的第一个SELECT,结果不依赖于外部结果集；<br>UNCACHEABLE SUBQUERY：结果集无法缓存的子查询；<br>UNION：UNION语句中第二个SELECT开始的后面所有SELECT,第一个SELECT为PRIMARY<br>UNION RESULT：UNION中的合并结果 
table | 所访问数据库中表的名称 
type | 访问方式：<br>ALL: 全表扫描<br>const: 常量，最多只有一条记录匹配，由于是常量，所以实际上只需要读一次<br>eq_ref: 最多只有一条匹配结果，一般是主键或者唯一索引来访问的<br>index: 全索引扫描<br>range: 索引范围扫描<br>ref: jion语句中被驱动表索引的引用查询<br>system: 系统表，表中只有一行数据
possible_keys | 可能使用到的索引
key | 使用的索引
key_len | 索引长度
rows | 估算出来的结果集的总记录数
extra | 额外信息



## 四 合理利用索引

### 1 索引的利弊
优点：提高数据检索速度，降低数据库的io成本
缺点：查询需要更新索引信息带来额外的资源消耗，索引还会占用额外的存储空间

### 2 怎么样有效的建立索引
1. 较频繁的作为条件的查询字段应该创建索引
2. 更新频繁的字段不适合建立索引
3. 唯一性太差的字段不适合建立索引（比如：性别、状态）
4. 不出现在where中的字段不适合建立索引
